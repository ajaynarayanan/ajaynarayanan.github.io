<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> AI for insect detection &amp; classification | Ajay Narayanan Sridhar </title> <meta name="author" content="Ajay Narayanan Sridhar"> <meta name="description" content="A simple, visual walkthrough of how AI can spot and identify insects using motion detection and YOLO."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ajaynarayanan.github.io/blog/2025/insect-detection/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "AI for insect detection & classification",
            "description": "A simple, visual walkthrough of how AI can spot and identify insects using motion detection and YOLO.",
            "published": "April 27, 2025",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Ajay Narayanan Sridhar </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>AI for insect detection &amp; classification</h1> <p>A simple, visual walkthrough of how AI can spot and identify insects using motion detection and YOLO.</p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#introduction">Introduction</a> </div> <div> <a href="#motion-detection-for-insects">Motion detection for insects</a> </div> <div> <a href="#insect-detection-with-yolo">Insect detection with YOLO</a> </div> <div> <a href="#conclusion-next-steps">Conclusion &amp; next steps</a> </div> </nav> </d-contents> <p>After conducting the <a href="https://insectnet.psu.edu/student-resources/sp25-virtual-workshop-ai-for-insect-detection-classification" rel="external nofollow noopener" target="_blank">AI for Insect Detection &amp; Classification Workshop</a><d-cite key="insectnetworkshop2025"></d-cite> at The Pennsylvania State University, I felt motivated to share some of the key ideas more widely.</p> <p>This blog post is designed for readers with little to no coding experience. The goal is to explain how simple motion detection and modern object detection models like YOLO<d-cite key="redmon2016you"></d-cite> can be used to monitor insects ‚Äî using visuals and plain language, without diving into heavy math or programming details. Images and videos used in the blog are obtained from the InsectEye<d-cite key="homan2023insecteye"></d-cite> system.</p> <p>I hope you find this exploration both accessible and interesting!</p> <h2 id="introduction">Introduction</h2> <p>Step into a field at dawn, and you‚Äôll hear a quiet symphony of tiny wings.<br> Some belong to helpful pollinators üêù, while others are hungry pests üêõ.</p> <p>Catching these insects early can protect crops, reduce chemical sprays, and help us understand how seasons and climate shape insect life. But how do you do that without draining batteries or overwhelming tiny edge devices?</p> <p>We use a <strong>two-step camera system</strong> that‚Äôs smart and simple:</p> <ol> <li> <strong>Notice insect motion</strong> ‚Äî ‚ÄúSomething moved.‚Äù</li> <li> <strong>Detect pests with YOLO</strong> ‚Äî ‚ÄúWhich insect is it?‚Äù</li> </ol> <p>Let‚Äôs dive into how motion spotting and fast object detection help keep a watchful eye on the fields ‚Äî one tiny wingbeat at a time.</p> <hr> <h2 id="motion-detection-for-insects">Motion detection for insects</h2> <div class="col-sm mt-3 mt-md-0 text-center"> <img src="/assets/blogs/insect_detection/motion_detection/insect.gif" class="img-fluid rounded z-depth-1" style="transform: rotate(180deg); margin-bottom: 20px;" alt="Insect GIF"> <br> <img src="/assets/blogs/insect_detection/motion_detection/motion_masks.gif" class="img-fluid rounded z-depth-1" style="transform: rotate(180deg);" alt="Motion Mask GIF"> </div> <div class="caption mt-2 text-center"> Fig. 1: Animated GIFs showing the insect video sequence (top) and the corresponding motion masks (bottom). </div> <p>When a camera sits still, most of the scene stays the same. If a handful of pixels suddenly change, that signals <strong>motion</strong>. Here‚Äôs a simple background subtraction method to pick out moving insects:</p> <ol> <li> <strong>Build a background model</strong><br> Watch the scene for a few seconds with no insects, then average those frames to create a ‚Äòclean‚Äô background image. Alternatively, use a single snapshot without any bugs. <div class="text-center my-2" style="line-height: 0;"> <img src="/assets/blogs/insect_detection/motion_detection/background_image.png" class="img-fluid rounded z-depth-1" style="transform: rotate(180deg); display: block; margin: 20 auto;" alt="Background Image"> <div class="caption text-center" style="margin-top: 20px; font-size: 0.9rem;"> Fig. 2: Background model for our video sequence. </div> </div> </li> <li> <strong>Frame difference</strong><br> <ul style="margin-top: 0.5rem; margin-bottom: 0;"> <li>Subtract the background model from the current frame to get a difference image.</li> <li>Large pixel differences usually mean motion.</li> <li>Threshold the difference image into a black-and-white motion mask (white = moving pixels; black = background).</li> </ul> </li> </ol> <div class="col-sm mt-3 mt-md-0 text-center"> <img src="/assets/blogs/insect_detection/motion_detection/motion_detection_mask.png" class="img-fluid rounded" style="margin-bottom: 20px;" alt="Motion Detection Mask"> </div> <div class="caption mt-2 text-center"> Fig. 3: Difference mask obtained by subtracting the current frame from the background and then thresholding. </div> <p>Motion detection is all around us. Here are a few real-world examples:</p> <ul style="margin-top: 0.5rem; margin-bottom: 0;"> <li>Security cameras &amp; intrusion alarms</li> <li>Sports highlights</li> <li>Wildlife monitoring (trail cams)</li> <li>Traffic flow analysis</li> </ul> <hr> <h2 id="insect-detection-with-yolo">Insect detection with YOLO</h2> <p>Motion detection points out <em>where</em> to look, and <strong>YOLO</strong> tells us <em>what</em> is moving. YOLO is an object detection model that draws boxes around objects and labels them. We use YOLO for insects because:</p> <ul> <li> <strong>Real-time:</strong> Runs at video speed, even on small devices.</li> <li> <strong>All-in-one:</strong> Finds both location and the insect‚Äôs identity in a single pass.</li> <li> <strong>Open-source:</strong> Free models (YOLOv8) and easy training tools are available.</li> </ul> <h3 id="the-quick-yolo-tour">The quick YOLO tour</h3> <ol> <li> <strong>Candidate frames</strong><br> <em>After motion detection, we extract snapshots that might contain insects.</em> <figure class="text-center"> <img src="/assets/blogs/insect_detection/yolo_steps/input_image.jpg" alt="Input Image" class="img-fluid rounded"> <figcaption class="mt-2" style="font-size: 0.9rem; color: #555;"> Fig. 4: Input image for insect detection, obtained from motion detection. </figcaption> </figure> </li> <li> <strong>Resize &amp; grid</strong><br> <em>Resize each snapshot to 448√ó448 pixels and overlay a 7√ó7 grid.</em> <figure class="text-center"> <img src="/assets/blogs/insect_detection/yolo_steps/cropped_grid_image.png" alt="Cropped and 7x7 grid overlayed image" class="img-fluid rounded"> <figcaption class="mt-2" style="font-size: 0.9rem; color: #555;"> Fig. 5: A 7√ó7 grid overlaid on the cropped image. </figcaption> </figure> </li> <li> <strong>One glance, many predictions</strong><br> <em>For each grid cell, YOLO‚Äôs neural network predicts several bounding boxes, confidence scores, and class probabilities for different insects.</em> <figure class="text-center"> <img src="/assets/blogs/insect_detection/yolo_steps/grid_cell_prediction.png" alt="YOLO grid cell predictions" class="img-fluid rounded"> <figcaption class="mt-2" style="font-size: 0.9rem; color: #555;"> Fig. 6: The green box has a high confidence score and class probability; the red boxes are low confidence. </figcaption> </figure> </li> <li> <strong>Keep the best</strong><br> <em>Non-Maximum Suppression (NMS)<d-cite key="hosang2017learning"></d-cite> keeps the highest-scoring box and removes overlapping, lower-scoring ones.</em> <figure class="text-center"> <img src="/assets/blogs/insect_detection/yolo_steps/non_maximum_suppression.png" alt="Non Maximum Suppression process" class="img-fluid rounded"> <figcaption class="mt-2" style="font-size: 0.9rem; color: #555;"> Fig. 7: NMS removes duplicate boxes, leaving one clear box per object. </figcaption> </figure> <p class="mt-2"> After predicting many boxes, NMS: </p> <ul style="margin-top: 0.5rem; margin-bottom: 0;"> <li>Keeps the box with the highest confidence score.</li> <li>Removes boxes that overlap too much (measured by Intersection over Union, or IoU).</li> </ul> <p> This leaves one clean box per insect. In our diagram, the green box remains and the yellow ones are discarded. </p> </li> <li> <strong>Final output</strong><br> <em>We get the insect‚Äôs class, a confidence score, and the bounding box coordinates.</em> </li> </ol> <p>You might be wondering:</p> <ol> <li> <strong>How are the bounding boxes represented?</strong> <figure class="text-center"> <img src="/assets/blogs/insect_detection/yolo_steps/bounding_box_representation.png" alt="Bounding box representation" class="img-fluid rounded"> <figcaption class="mt-2" style="font-size: 0.9rem; color: #555;"> Fig. 8: Bounding box representation. </figcaption> </figure> <ul style="margin-top: 0.5rem; margin-bottom: 0;"> <li>Each box is defined by (cx, cy, w, h).</li> <li>(cx, cy) is the box center, normalized within its grid cell.</li> <li>(w, h) is the width and height, relative to the full image.</li> </ul> </li> <li> <strong>What if the insect overlaps two grid cells?</strong> <figure class="text-center"> <img src="/assets/blogs/insect_detection/yolo_steps/overlapping_grid_cells.png" alt="Overlapping grid cells" class="img-fluid rounded"> <figcaption class="mt-2" style="font-size: 0.9rem; color: #555;"> Fig. 9: Handling overlapping grid cells. </figcaption> </figure> <ul style="margin-top: 10px;"> <li>Only the cell (marked as 1) containing the insect‚Äôs center (marked by a star) makes the prediction.</li> <li>Neighboring cells ignore this insect and focus on objects whose centers lie inside them.</li> </ul> </li> </ol> <hr> <h2 id="conclusion--next-steps">Conclusion &amp; next steps</h2> <p>Combining <strong>motion detection</strong> with <strong>YOLO</strong> creates a nimble tag-team. On a 90,000-frame video, motion detection trimmed the candidates down to just 1,000 frames. This shows why pairing motion and object detection is essential for bio-monitoring systems that run on tight compute and energy budgets.</p> <p>Next on our roadmap:</p> <ul> <li> <strong>See even smaller bugs</strong> ‚Äî add a zoom lens or train YOLO with clearer close-ups.</li> <li> <strong>Dashboards for farmers</strong> ‚Äî stream live counts to a phone app for same-day action.</li> </ul> <p>Have ideas, questions, or cool bug clips? Drop a comment below ‚Äî we‚Äôd love to chat! ü™≤üëã</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2025-04-27-insect-detection.bib"></d-bibliography> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'ajaynarayanan/ajaynarayanan.github.io',
        'data-repo-id': '',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> ¬© Copyright 2025 Ajay Narayanan Sridhar. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>